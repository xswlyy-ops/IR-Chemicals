<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lab Barcode Scanner</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: #f6f8fa;
  padding: 10px;
  max-width: 520px;
  margin: auto;
}

/* åŒºå— */
.section {
  background: #fff;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 12px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);
}

/* æ‰«æçª—å£ï¼šæ‰‹æœºä¼˜å…ˆ */
#reader {
  width: 100%;
  height: 45vh;        /* å…³é”®ï¼šå æ‰‹æœºé«˜åº¦ */
  min-height: 260px;
  max-height: 420px;
  border: 1px solid #ccc;
  margin-bottom: 8px;
}

/* æ–‡æœ¬ */
h3 {
  margin: 6px 0 10px;
  font-size: 18px;
}

label {
  font-weight: 600;
  margin-top: 6px;
  display: block;
  font-size: 14px;
}

/* è¾“å…¥æ¡† */
input {
  width: 100%;
  padding: 7px;
  margin-top: 4px;
  font-size: 14px;
}

/* æŒ‰é’®ï¼šä¸å¤¸å¼  */
button {
  width: 100%;
  padding: 8px;
  margin-top: 8px;
  font-size: 14px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

/* æŒ‰é’®é…è‰² */
.primary { background: #2da44e; color: white; }
.secondary { background: #0969da; color: white; }
.danger { background: #cf222e; color: white; }

/* çŠ¶æ€æç¤º */
#status {
  font-size: 13px;
  margin-top: 4px;
  color: #2da44e;
}

/* è¡¨æ ¼ */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}

th, td {
  border: 1px solid #ccc;
  padding: 5px;
  text-align: center;
}

th {
  background: #f0f2f4;
}

/* æ¡Œé¢ç«¯å¾®è°ƒ */
@media (min-width: 768px) {
  #reader {
    height: 320px;
  }

  body {
    max-width: 640px;
  }
}
  </style>

</head>
<body>

<h3>ğŸ“¦ label Chemicals</h3>

<div id="reader"></div>
<button onclick="switchCamera()">ğŸ” åˆ‡æ¢æ‘„åƒå¤´</button>

<label>Code</label>
<input id="codeInput" placeholder="æ‰«ææ¡å½¢ç æˆ–æ‰‹åŠ¨è¾“å…¥">

<label>Name</label>
<input id="nameInput" placeholder="è¯å“åç§°">

<label>Location</label>
<input id="locationInput" placeholder="å¦‚ï¼šå†·è—æŸœB-1">

<button onclick="addRecord()">â• æ·»åŠ è®°å½•</button>
<button onclick="exportCSV()">ğŸ’¾ å¯¼å‡º CSV</button>

<h3>å½“å‰è®°å½•</h3>
<table border="1" id="recordTable">
  <thead>
    <tr>
      <th>label</th>
      <th>name</th>
      <th>location</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  const html5QrCode = new Html5Qrcode("reader");
  let facingMode = "environment"; // é»˜è®¤åç½®

  function startScanner() {
    html5QrCode.start(
      { facingMode: facingMode },
      {
        fps: 10,
        qrbox: (viewfinderWidth, viewfinderHeight) => {
  return {
    width: viewfinderWidth * 0.9,
    height: viewfinderHeight * 0.5
  };
} };
}, // æ¡å½¢ç ç”¨â€œæ¨ªæ¡†â€
        formatsToSupport: [
          Html5QrcodeSupportedFormats.CODE_128,
          Html5QrcodeSupportedFormats.EAN_13,
          Html5QrcodeSupportedFormats.EAN_8,
          Html5QrcodeSupportedFormats.UPC_A,
          Html5QrcodeSupportedFormats.UPC_E
        ]
      },
      (decodedText) => {
        document.getElementById("codeInput").value = decodedText;
      }
    );
  }

  function switchCamera() {
    html5QrCode.stop().then(() => {
      facingMode = facingMode === "environment" ? "user" : "environment";
      startScanner();
    });
  }

  startScanner();
</script>
<script>
  const records = [];

  function addRecord() {
    const code = codeInput.value.trim();
    const name = nameInput.value.trim();
    const location = locationInput.value.trim();
    const time = new Date().toLocaleString();

    if (!code || !name || !location) {
      alert("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯");
      return;
    }

    const record = { code, name, location, time };
    records.push(record);
    appendRow(record);

    // æ¸…ç©ºè¾“å…¥ï¼ˆæ‰«ç ä¸‹ä¸€ä¸ªï¼‰
    nameInput.value = "";
    locationInput.value = "";
  }

  function appendRow(r) {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${r.code}</td>
      <td>${r.name}</td>
      <td>${r.location}</td>
      <td>${r.time}</td>
    `;
    document.querySelector("#recordTable tbody").appendChild(row);
  }

  function exportCSV() {
    if (records.length === 0) {
      alert("æš‚æ— è®°å½•");
      return;
    }

    let csv = "ç¼–å·,è¯å“åç§°,å­˜æ”¾ä½ç½®,è®°å½•æ—¶é—´\n";
    records.forEach(r => {
      csv += `"${r.code}","${r.name}","${r.location}","${r.time}"\n`;
    });

    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "lab_inventory.csv";
    a.click();
    URL.revokeObjectURL(url);
  }
</script>
</body>
</html>





